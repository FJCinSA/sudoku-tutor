<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Sudoku Tutor</title>

  <!--
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    SUDOKU TUTOR  (v2 ‚Äî improved)
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    A teaching-first Sudoku app that explains WHY a number
    goes where it does, not just what the answer is.

    FILE STRUCTURE
    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    index.html  ‚Üê this file ‚Äî HTML skeleton & page structure
    style.css   ‚Üê all visual styling, colours, animations
    engine.js   ‚Üê puzzle generation & solving logic (pure JS)
    hints.js    ‚Üê technique detection & explanations
    render.js   ‚Üê reads Game state, writes to the DOM
    game.js     ‚Üê state object, all user actions, keyboard

    LOAD ORDER: engine ‚Üí hints ‚Üí render ‚Üí game
    Each file depends only on those before it.

    KEY FEATURES
    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    ‚Ä¢ 5 difficulty levels (Beginner ‚Üí Expert)
    ‚Ä¢ Tutor tab: real-time hints with step-by-step explanations
    ‚Ä¢ Lessons tab: structured learning path
    ‚Ä¢ Techniques tab: reference library (Naked Single ‚Üí X-Wing)
    ‚Ä¢ Pencil notes with auto-fill and auto-clear
    ‚Ä¢ Score + streak bonuses + animated feedback
    ‚Ä¢ Undo, pause, check mode, sound
    ‚Ä¢ Keyboard: 1-9 place, Backspace erase, N notes, P pause,
                Ctrl+Z undo, Arrow keys navigate
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  -->

  <link rel="stylesheet" href="style.css">
</head>

<body style="padding-top:40px;">

  <!-- ‚îÄ‚îÄ Ecosystem nav ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       Links to all three tools. Consistent across ecosystem.
  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div id="ecoNav" style="
    position:fixed; top:0; left:0; right:0; z-index:300;
    display:flex; justify-content:space-between; align-items:center;
    padding:0 20px; height:40px;
    background:#09080698;
    -webkit-backdrop-filter:blur(12px);
    backdrop-filter:blur(12px);
    border-bottom:1px solid #2a261a66;
    font-family:'Georgia',serif;
  ">
    <a href="https://fjcinsa.github.io/sudoku-mastery/" style="
      color:#c8a96e; font-size:.62rem; letter-spacing:.12em;
      text-transform:uppercase; text-decoration:none; font-family:Georgia,serif;
    ">Sudoku Mastery</a>
    <div style="display:flex; gap:18px; align-items:center;">
      <a href="https://fjcinsa.github.io/sudoku-mastery/" style="
        color:#7a6e58; font-size:.58rem; letter-spacing:.12em;
        text-transform:uppercase; text-decoration:none;
      ">Course</a>
      <a href="https://fjcinsa.github.io/sudoku-helper/" style="
        color:#7a6e58; font-size:.58rem; letter-spacing:.12em;
        text-transform:uppercase; text-decoration:none;
      ">Helper</a>
      <a href="https://fjcinsa.github.io/sudoku-mastery/course.html" style="
        color:#c8a96e; font-size:.58rem; letter-spacing:.12em;
        text-transform:uppercase; text-decoration:none;
        border:1px solid #c8a96e66; padding:3px 10px; border-radius:3px;
      ">Learn Free</a>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ Loading overlay ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       Shown for ~200 ms while the first puzzle generates.
       Prevents the UI from looking frozen on load.
  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div id="loadOverlay" class="show" aria-live="polite">
    <span>Generating puzzle‚Ä¶</span>
  </div>

  <!-- ‚îÄ‚îÄ App header ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       Title + tagline.  Georgia serif to match the board.
  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <h1>Sudoku Tutor</h1>
  <div class="sub" title="Learn solving techniques while you play">Learn ¬∑ Solve ¬∑ Master</div>
  <div style="margin-top:6px;">
    <a href="https://fjcinsa.github.io/sudoku-mastery/" target="_blank" class="learn-link">
      üìñ Learn the techniques ‚Üí
    </a>
  </div>

  <!-- ‚îÄ‚îÄ Difficulty selector ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       Five buttons: Beginner / Easy / Medium / Hard / Expert.
       Clicking any button starts a fresh puzzle.
       Built by Render.difficulty() on every Render.all().
  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="dbar" id="dB" role="group" aria-label="Difficulty selector"></div>

  <!-- ‚îÄ‚îÄ Stats bar ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       ‚ùå mistakes  ‚ö° score  üî• streak  ‚è± time elapsed
       Updated every second; each span has a tooltip.
  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="info" role="status" aria-label="Game stats">
    <span id="xM" title="Number of mistakes (each costs 15 points)">‚ùå 0</span>
    <span id="xS" title="Score (+10 per correct digit, +25 for 5+ streak)">‚ö° 0</span>
    <span id="xK" title="Current correct-placement streak"></span>
    <span id="xT" title="Time elapsed">00:00</span>
  </div>

  <!-- ‚îÄ‚îÄ Progress bar ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       Gold fill advances left-to-right as cells are solved.
       Width is set via JS; glows briefly after each correct cell.
  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="pbar" role="progressbar" aria-label="Puzzle completion"
       aria-valuemin="0" aria-valuemax="100">
    <div class="pf" id="pF" style="width:0%"
         title="Puzzle completion percentage"></div>
  </div>

  <!-- ‚îÄ‚îÄ 9√ó9 board ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       81 cells built dynamically by Render.board().
       data-r / data-c attributes identify each cell's position.
       Clicking a cell calls selectCell(r, c).
  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="board" id="brd" role="grid" aria-label="Sudoku board"></div>

  <!-- ‚îÄ‚îÄ Action buttons ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       Built by Render.actions().  Buttons:
         ‚úè Notes   ‚Äî toggle pencil-note mode (blue border)
         ‚úï Erase   ‚Äî clear selected cell
         ‚Ü© Undo    ‚Äî reverse last action
         üìù Auto   ‚Äî fill all candidates as notes
         ‚úì Check   ‚Äî toggle instant error feedback
         üîä/üîá    ‚Äî toggle sound
         ‚è∏/‚ñ∂     ‚Äî pause / resume
       Each button has a tooltip (title attribute).
  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="acts" id="act" role="toolbar" aria-label="Game actions"></div>

  <!-- ‚îÄ‚îÄ Number pad ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       9 buttons (1-9), built by Render.numpad().
       Each shows the digit and a small "placed/9" counter.
       Button is greyed out when all 9 of that digit are placed.
  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="np" id="nup" role="toolbar" aria-label="Number pad"></div>

  <!-- ‚îÄ‚îÄ Teaching panel ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       Tabbed area below the number pad.

       üí° Tutor tab
          Context-sensitive messages appear here whenever you:
          ‚Ä¢ tap a cell (shows candidate count or hint)
          ‚Ä¢ make a correct or wrong placement
          ‚Ä¢ use Show Move (shows technique + explanation)
          Buttons: "Show Move" (highlight next move) and
                   "Place N"   (apply hint automatically)

       üìñ Lessons tab
          Structured learning path ‚Äî five expandable cards:
          The Rules ‚Üí Scanning ‚Üí Naked Singles ‚Üí
          Hidden Singles ‚Üí Notes Mastery

       üß© Techniques tab
          Reference accordion for five solving strategies:
          Naked Single ‚Üí Hidden Single ‚Üí Naked Pair ‚Üí
          Pointing Pair ‚Üí X-Wing
          Each entry has: description, how-to, example.
  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="pn" role="complementary" aria-label="Teaching panel">
    <div class="tbs" id="tbs" role="tablist"></div>
    <div class="tbd" id="tbd" role="tabpanel"></div>
  </div>

  <!-- ‚îÄ‚îÄ Win modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       Full-screen overlay, shown when all 81 cells are correct.
       Displays: time, score, mistakes.
       Buttons: "Play Again" (same difficulty) / "Next ‚Üí" (harder).
  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div class="mo" id="wM" role="dialog" aria-modal="true" aria-label="Puzzle complete">
    <div class="mi2">
      <div style="font-size:2.2rem;margin-bottom:8px" aria-hidden="true">üèÜ</div>
      <h2>Puzzle Complete!</h2>
      <p id="wP"></p>
      <div class="mbs">
        <button class="bp" onclick="newGame(Game.difficulty)"
          title="Start a new puzzle at the same difficulty level">
          Play Again
        </button>
        <button class="bs" onclick="nextLevel()"
          title="Advance to the next difficulty level">
          Next ‚Üí
        </button>
      </div>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ JavaScript modules ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       Loaded in dependency order:
         engine.js  ‚Äî pure puzzle logic, no DOM
         hints.js   ‚Äî technique detection, needs Engine
         render.js  ‚Äî DOM drawing, needs Game + Engine
         game.js    ‚Äî state + controls, needs all three
                      calls newGame('easy') at the bottom
  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <script src="engine.js"></script>   <!-- no dependencies -->
  <script src="hints.js"></script>    <!-- needs Engine     -->
  <script src="render.js"></script>   <!-- needs Game state -->
  <script src="game.js"></script>     <!-- needs all three  -->

  <!-- ‚îÄ‚îÄ Strike Banner ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
       Watches the mistake counter. After 3 mistakes the
       banner slides up from the bottom, linking to the
       Sudoku Mastery course. Dismissible. Resets on new game.
  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div id="strikeBanner" class="sb" role="alert" aria-live="polite">
    <div class="sb-inner">
      <button class="sb-close" onclick="dismissBanner()" aria-label="Dismiss">‚úï</button>
      <div class="sb-icon">üí°</div>
      <div class="sb-title">Everyone gets stuck.</div>
      <div class="sb-text">The course shows you exactly why ‚Äî and fixes it in six chapters.</div>
      <div class="sb-meta">Free ¬∑ No signup required</div>
      <a class="sb-btn" href="https://fjcinsa.github.io/sudoku-mastery/course.html"
         target="_blank" rel="noopener">Open the Course ‚Üí</a>
    </div>
  </div>

  <style>
  .sb {
    display:none; position:fixed; bottom:0; left:0; right:0; z-index:200;
    padding:14px 20px;
    background:#161410ee;
    border-top:2px solid #c8a96e;
    backdrop-filter:blur(10px);
    -webkit-backdrop-filter:blur(10px);
  }
  .sb.show { display:block; animation:sbUp .35s ease; }
  @keyframes sbUp { from{transform:translateY(100%)} to{transform:translateY(0)} }
  .sb-inner {
    max-width:480px; margin:0 auto; text-align:center; position:relative;
    padding:4px 32px 0;
  }
  .sb-close {
    position:absolute; right:-8px; top:-4px;
    background:none; border:none; cursor:pointer;
    color:#6b5f48; font-size:.9rem; padding:4px 8px; line-height:1;
    transition:color .15s;
  }
  .sb-close:hover { color:#e8dcc8; }
  .sb-icon { font-size:1.3rem; margin-bottom:3px; }
  .sb-title {
    font-family:'Georgia',serif; font-size:.97rem;
    color:#e2c070; margin-bottom:3px; font-weight:600;
  }
  .sb-text {
    font-size:.8rem; color:#b8a880; line-height:1.5; margin-bottom:3px;
  }
  .sb-meta {
    font-size:.65rem; color:#6b5f48; margin-bottom:10px;
    letter-spacing:.1em; text-transform:uppercase;
  }
  .sb-btn {
    display:inline-block; padding:8px 22px;
    background:#c8a96e; border-radius:3px;
    color:#090806; font-weight:600; text-decoration:none;
    font-size:.8rem; transition:background .2s;
  }
  .sb-btn:hover { background:#e2c070; }
  .learn-link {
    font-family:Georgia,serif; font-size:.68rem; letter-spacing:.15em;
    text-transform:uppercase; color:#6b5f4a; text-decoration:none;
    border-bottom:1px solid #3a3228; padding-bottom:1px; transition:color .2s;
  }
  .learn-link:hover { color:#c8a96e; }
  </style>

  <script>
  (function() {
    var shown = false;
    var banner = document.getElementById('strikeBanner');
    var target = document.getElementById('xM');
    if (!target || !banner) return;

    // Single observer handles both trigger (‚â•3) and reset (back to 0)
    new MutationObserver(function() {
      var n = parseInt((target.textContent || '').replace(/[^0-9]/g, ''), 10);
      if (isNaN(n)) return;
      if (n >= 3 && !shown) {
        shown = true;
        banner.classList.add('show');
      } else if (n === 0 && shown) {
        shown = false;
        banner.classList.remove('show');
      }
    }).observe(target, { childList:true, subtree:true, characterData:true });
  })();

  function dismissBanner() {
    document.getElementById('strikeBanner').classList.remove('show');
  }
  </script>

  <!-- ‚îÄ‚îÄ Floating Feedback Widget ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div id="fbBtn" onclick="toggleFeedback()" style="
    position:fixed; bottom:20px; right:20px; z-index:400;
    width:48px; height:48px; border-radius:50%;
    background:#c8a96e; color:#090806;
    display:flex; align-items:center; justify-content:center;
    font-size:1.3rem; cursor:pointer;
    box-shadow:0 4px 16px #00000060;
    transition:transform .2s, background .2s;
  " title="Give feedback">‚òÖ</div>

  <div id="fbPanel" style="
    display:none; position:fixed; bottom:76px; right:20px; z-index:400;
    width:260px; background:#111009; border:1px solid #2e2a1e;
    border-radius:8px; padding:20px;
    box-shadow:0 8px 32px #00000080;
    font-family:Georgia,serif;
  ">
    <div style="font-size:.62rem; letter-spacing:.2em; text-transform:uppercase;
      color:#6b5f48; margin-bottom:14px;">Rate Sudoku Tutor</div>

    <div id="fbStars" style="display:flex; gap:6px; margin-bottom:14px;">
      <span onclick="setRating(1)" data-v="1" style="font-size:1.8rem; color:#2a261a; cursor:pointer; transition:color .15s; user-select:none;">‚òÖ</span>
      <span onclick="setRating(2)" data-v="2" style="font-size:1.8rem; color:#2a261a; cursor:pointer; transition:color .15s; user-select:none;">‚òÖ</span>
      <span onclick="setRating(3)" data-v="3" style="font-size:1.8rem; color:#2a261a; cursor:pointer; transition:color .15s; user-select:none;">‚òÖ</span>
      <span onclick="setRating(4)" data-v="4" style="font-size:1.8rem; color:#2a261a; cursor:pointer; transition:color .15s; user-select:none;">‚òÖ</span>
      <span onclick="setRating(5)" data-v="5" style="font-size:1.8rem; color:#2a261a; cursor:pointer; transition:color .15s; user-select:none;">‚òÖ</span>
    </div>

    <textarea id="fbText" placeholder="Any suggestions? (optional)" rows="3" style="
      width:100%; padding:10px 12px; margin-bottom:10px;
      background:#090806; border:1px solid #2a261a;
      border-radius:3px; color:#ede0c8;
      font-family:Georgia,serif; font-size:.82rem;
      resize:none; outline:none; line-height:1.5;
    "></textarea>

    <button onclick="submitFeedbackTutor()" style="
      width:100%; padding:10px;
      background:#c8a96e; color:#090806;
      border:none; border-radius:3px; cursor:pointer;
      font-family:Georgia,serif; font-size:.82rem; font-weight:600;
      transition:background .2s;
    ">Send Feedback ‚Üí</button>

    <div id="fbThanks" style="
      display:none; margin-top:10px; font-size:.78rem;
      color:#5a9a5a; font-family:Georgia,serif; text-align:center;
    ">‚úì Thanks ‚Äî your feedback helps improve the tool</div>
  </div>

  <script>
  var fbRating = 0;

  function toggleFeedback() {
    var p = document.getElementById('fbPanel');
    p.style.display = p.style.display === 'none' ? 'block' : 'none';
  }

  function setRating(val) {
    fbRating = val;
    document.querySelectorAll('#fbStars span').forEach(function(s) {
      s.style.color = parseInt(s.dataset.v) <= val ? '#c8a96e' : '#2a261a';
    });
  }

  function submitFeedbackTutor() {
    var suggestion = document.getElementById('fbText').value.trim();
    var thanks = document.getElementById('fbThanks');
    if (!fbRating && !suggestion) {
      thanks.textContent = 'Please select a star rating first.';
      thanks.style.color = '#c8732a';
      thanks.style.display = 'block';
      return;
    }
    thanks.textContent = '‚úì Thanks ‚Äî your feedback helps improve the tool';
    thanks.style.color = '#5a9a5a';
    thanks.style.display = 'block';
    document.querySelector('#fbPanel button').style.display = 'none';
    var stars = '‚òÖ'.repeat(fbRating) + '‚òÜ'.repeat(5 - fbRating);
    var body = 'Tool: Sudoku Tutor\nRating: ' + stars + ' (' + fbRating + '/5)\n\nSuggestion: ' + (suggestion || 'None');
    window.location.href = 'mailto:sudokumasterycourse@gmail.com?subject=Sudoku Tutor Feedback&body=' + encodeURIComponent(body);
  }
  </script>

</body>
</html>